/*
*Anastasia Cherkasova
*st140594@student.spbu.ru
*LabWork1
*/
#ifndef BMP_IMAGE_H
#define BMP_IMAGE_H

#include "IImage.h"
#include <vector>
#include <string>
#include <cstdint>

class BMPImage : public IImage {
public:
    BMPImage() = default;

    bool load(const std::string& filename) override;
    bool save(const std::string& filename) override;

    void rotate90clockwise() override;
    void rotate90counter() override;
    void applyGaussian3x3() override;

    int getWidth() const { return width; }
    int getHeight() const { return height; }

    const std::vector<uint8_t>& getPixelData() const { return pixelData; }

private:
    int width = 0;
    int height = 0;

    std::vector<uint8_t> bmpHeader;
    std::vector<uint8_t> dibHeader;
    std::vector<uint8_t> pixelData;

    static constexpr int BMP_HEADER_SIZE = 14;
    static constexpr int DIB_HEADER_SIZE = 40;
    static constexpr int BITS_PER_PIXEL = 24;

    int calculateRowSize(int w) const {
        return ((BITS_PER_PIXEL * w + 31) / 32) * 4;
    }
};

#endif

